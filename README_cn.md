### 项目介绍

bsdiff是一个用来生成和应用二进制差分补丁的工具。它采用了Larsson和Sadakane的qsufsort算法,利用可执行文件中的变化特性,生成的补丁比Xdelta小50-80%,比商业产品RTPatch小15%。

仓库包含bsdiff和bspatch两个主程序,以及相关文档如README、许可证文件等。代码主要使用C语言开发,还依赖bzip2工具。README给出了算法原理以及项目作者Colin Percival的一篇未发表论文,建议在引用该项目时应引用这篇论文。

仓库目前没有任何发布版本,也没有其他语言包或活动。整体来看,这个项目实现了一个高效的二进制差分工具,能生成体积更小的补丁文件,主要用于Linux和类Unix系统。

### 原理介绍

bsdiff算法的主要思路是:

1. 对old文件和new文件进行后缀排序。通过qsufsort算法对两个文件进行后缀排序,这样可以找到相同后缀片段的位置。

2. 找到相同后缀片段,将它们看作是原子单元不做差分。可以大大提高差分效率。

3. 对剩余的不相同部分进行差分。首先找出old文件中出现在new文件中的片段,记录它们的位置。然后对没有匹配片段进行字节级的差分。

4. 将位置记录和差分结果gzip压缩成补丁文件。

应用算法主要步骤是:

1. 根据补丁文件还原位置记录表。

2. 用位置表在old文件中查找匹配片段,还原到新的文件中。

3. 对差分部分依次应用每个字节的差分,还原未匹配部分。

4. 还原完成新的文件。

相比一般二进制差分算法,bsdiff的亮点在于:

1. 通过后缀排序找到最大连续相同区域,大大提高效率。

2. 只对未匹配部分做差分,节约差分量。

3. 将结果gzip压缩,再次节约空间。

因此它生成的补丁文件通常比xdelta等算法小50%左右,精髓在于充分利用可执行文件中不随意变动的特点。这种算法适用于二进制可执行文件和配置文件差分场景。
